/* ainojs-react-image v1.1.2 - April 14th 2015 - (c) Aino - MIT Licensed */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.ReactImage=t()}}(function(){return function t(e,o,n){function i(a,s){if(!o[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var d=o[a]={exports:{}};e[a][0].call(d.exports,function(t){var o=e[a][1][t];return i(o?o:t)},d,d.exports,t,e,o,n)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(){},{}],2:[function(t,e){var o=t("react"),n="undefined"==typeof window,i=function(t,e){t=t.map(function(t){return parseInt(t,10)}).sort(function(t,e){return t-e});for(var o=0,n=t[o];e>t[o]&&t[o++];)n=t[o];return n},r=n?1:window.devicePixelRatio||1;e.exports=o.createClass({getInitialState:function(){return{loading:!0,display:"",fallback:"",padding:0,shouldload:!1}},getDefaultProps:function(){return{alt:"",threshold:n&&window.navigator.userAgent.match(/iPhone/i)?500:50,onLoad:function(){}}},getImage:function(t){var e=this.props.src;if("string"==typeof e)return e;if("[object Object]"==Object.prototype.toString.call(e)){var o=Object.keys(e);return e[i(o,t*r)]}throw new TypeError('"src" must be a string or object')},componentWillMount:function(){var t=0;this.props.ratio&&(t=Math.round(1e4*this.props.ratio)/100),this.setState({fallback:this.getImage(500),padding:t})},componentDidMount:function(){this.props.lazy&&!n&&window.addEventListener("scroll",this.onScroll);var t=this.getDOMNode().parentNode,e=t.getBoundingClientRect().width;this.setState({display:this.getImage(e),shouldload:!this.props.lazy},function(){this.onScroll(),this.load()})},load:function(){if(this.isMounted()&&this.state.shouldload){var t=new Image;t.onload=this.onImageLoad,t.src=this.state.display}},onScroll:function(){if(!n){if(this.state.shouldload||!this.isMounted())return void this.removeScrollListener();var t=this.getDOMNode().getBoundingClientRect();t.bottom>-this.props.threshold&&t.top<window.innerHeight+this.props.threshold&&this.setState({shouldload:!0},this.load)}},removeScrollListener:function(){n||window.removeEventListener("scroll",this.onScroll)},componentWillUnmount:function(){this.removeScrollListener()},onImageLoad:function(t){this.isMounted()&&this.setState({loading:!1,padding:this.state.padding||Math.round(t.target.height/t.target.width*1e4)/100},function(){this.props.onLoad(t.target)})},render:function(){var t=["image-container"],e={},n={paddingBottom:this.state.padding+"%",position:"relative"};this.state.loading?t.push(this.state.shouldload?"loading":"waiting"):e={backgroundImage:"url("+this.state.display+")",backgroundSize:"cover",backgroundPosition:"50% 50%",backgroundRepeat:"no-repeat",position:"absolute",width:"100%",height:"100%",top:0,left:0},this.props.lazy&&t.push("lazy");var i="width:100%";this.state.padding&&(i+=";position:absolute;top:0;left:0");var r={__html:'<img src="'+this.state.fallback+'" style="'+i+'" alt="'+this.props.alt+'">'},a=o.createElement("noscript",{dangerouslySetInnerHTML:r}),s=o.createElement("div",{className:"image",style:e},a);return o.createElement("div",{className:t.join(" "),style:n},s)}})},{}]},{},[2])(2)});